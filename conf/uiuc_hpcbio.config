/*
 * -------------------------------------------------
 *  HPC cluster config file - UIUC IGB Biocluster
 * -------------------------------------------------
 * http://biocluster.igb.illinois.edu
 * 
 * NOTE: this is currently set up for internal HPCBio use, note the below settings may need to be 
 * modified if you are trying to use this for non-HPCBio use
 * 
 */

singularity {
    enabled = true
    cacheDir = params.singularity_cache_dir
    autoMounts = true
}

params {
    config_profile_description = 'University of Illinois IGB Biocluster set up, base provided by nf-core/configs.'
    config_profile_contact = 'Chris Fields (cjfields - at - illinois.edu)'
    config_profile_url = 'https://http://biocluster.igb.illinois.edu/'
    singularity_cache_dir = "/home/groups/hpcbio/singularity"
    igenomes_base = '/home/groups/hpcbio/references'
    max_memory = 500.GB
    max_cpus = 24
    max_time = 1000.h
    hpc_queue = 'hpcbio'
    genome = 'GRCh38'
    // Genome reference file paths
    genomes {
        'NC_045512.2' {
          fasta = "/home/groups/hpcbio/projects/CBC/2020-Dec-Test-ViralRecon/data/reference/GCF_009858895.2_ASM985889v3_genomic.fna"
          gff   = "/home/groups/hpcbio/projects/CBC/2020-Dec-Test-ViralRecon/data/reference/GCF_009858895.2_ASM985889v3_genomic.gff"
        }
        'MN908947.3' {
          fasta = "/home/groups/hpcbio/projects/CBC/2020-Dec-Test-ViralRecon/data/reference/GCA_009858895.3_ASM985889v3_genomic.fna"
          gff   = "/home/groups/hpcbio/projects/CBC/2020-Dec-Test-ViralRecon/data/reference/GCA_009858895.3_ASM985889v3_genomic.gff"
        }
    }   
}

process {
    executor = 'slurm'
    queue = params.hpc_queue
    // Increasing maxRetries, this will overwrite what we have in base.config
    maxRetries = 3
    clusterOptions = params.hpc_account
    stageInMode = 'symlink'
    stageOutMode = 'rsync'
}

executor {
    queueSize = 4
}
